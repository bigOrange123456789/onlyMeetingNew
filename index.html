<!DOCTYPE html>
<html lang="en">
	<head>
		<title>MEETING</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {overflow:hidden;}
		</style>
		<script src="js/Network.js"></script>
	</head>
	<body style="margin: 0">
	<script src="js/lib/threeJS/three.js"></script>
	<script src="js/lib/threeJS/GLTFLoader.js"></script>

	<script src="js/lib/pmLib/MyPMLoader.js"></script>
	<script src="js/VideoManager.js"></script>

	<script src="js/ParamMeasure.js"></script>
	<script src="js/Main.js"></script>
	<script src="js/Pack.js"></script>
	<div id="cheat" style="position:absolute;left:0;right:0;background-size:100%;background:#01f;">
		<img id="bg" src="data:image/jpeg;base64,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" style="background-size:100%;position:absolute;left:0;right:0;" />
	</div>
	<script>

	</script>

	<script  type="module">
		import {SeatManager}from'./js/sceneSet/SeatManager.js'
		import {AvatarManager} from './js/sceneSet/AvatarManager.js';
		import {RoomManager} from './js/sceneSet/RoomManager.js';
		import {PreviewManager} from './js/playerControl/PreviewManager.js';
		import {Net} from './js/simulate/Net.js';
		import {Blur}from'./js/Blur.js'
		import {PlayerControl}from'./js/playerControl/PlayerControl.js'
		new Blur()

		window.videoMaterial=new THREE.MeshBasicMaterial();

		var texture = new THREE.Texture();
		texture.image =document.getElementById("bg");
		texture.needsUpdate = true;
		texture.flipY=false;
		texture.wrapS=texture.wrapT=THREE.ClampToEdgeWrapping;
		texture.minFilter=THREE.LinearFilter;
		texture.magFilter=THREE.LinearFilter;
		texture.format=THREE.RGBFormat;
		window.videoMaterial.map=texture;

		var myMain = new Main();
		myMain.start();
		window.camera=myMain.camera;
		//document.body.appendChild( VRButton.createButton( myMain.renderer ) );
		//myMain.renderer.xr.enabled = true;

		var myVideoManager = new VideoManager();

		var myRoomManager = new RoomManager(myVideoManager,myMain.camera);
		myMain.scene.add(myRoomManager.room);

		new PlayerControl(myMain.camera);//.cullingTest(myMain.scene)

		var mySeatManager = new SeatManager();
		mySeatManager.create();//椅子
		myMain.scene.add(mySeatManager.chairs);

		var myAvatarManager = new AvatarManager(mySeatManager, myMain.camera);
		myMain.scene.add(myAvatarManager.obj);

		//myRoomManager.create1();//网格
		myAvatarManager.create1(function () {
			//myRoomManager.create2();//贴图
			myAvatarManager.create2();//嘉宾
		});//听众

		var net=new Net().object;
		net.position.set(170,17,-59)
		net.scale.set(-0.03,0.03,0.04)
		net.rotation.set(0,Math.PI/2,0)
		myMain.scene.add(net);

		net=new Net().object;
		net.position.set(170,17,29)
		net.scale.set(0.03,0.03,0.04)
		net.rotation.set(0,Math.PI/2,0)
		myMain.scene.add(net);
		//new ParamMeasure(net,0)

		const light = new THREE.PointLight( 0xffffff, 1 );
		light.position.set(0,40.97,0)
		light.rotation.set(0,Math.PI/2,0)
		//light.rotation.set(Math.PI/2,0,0);
		myMain.scene.add(light)

		/*
		const geometry = new THREE.BoxGeometry( 5, 40, 5 );
		const material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
		const cube = new THREE.Mesh( geometry, material );
		light.add( cube );
		*/

		//开始自动漫游路径
		var mydata = [//自动漫游路径
			//x         y      z      angel       time  展板编号  展板初始旋转(单位是90度)
			[-155, 41, 22, -1.5572, -1.47875, -1.55714, 80]
			, [-119, 39, 24, -0.91, -1.48, -0.91, 80]
			, [-59, 48, -14, -1.25, -1.52, -1.24, 80]
			, [-122,39,-116,-2.863791,-1.04, -2.8,80]
			, [129, 37, -66, -1.25, -1.52, -1.24, 200]

			, [186.629944, 26.749136,-64.9026,-1.678751829760329,-1.183107113654890, -1.68733072496894, 50]
			, [186.629944, 26.749137,-64.9027,-1.678751829760328,-1.183107113654891, -1.68733072496893, 100]
				//184.61, 26.1, -64.97
			, [130, 37, -12, -1.25, -1.52, -1.24, 50]
			, [129, 37, -27, -1.25, -1.52, -1.24, 50]
			, [229, 29, -19, -1.21, 1.46, 1.19, 80]
			, [183, 63, -19, -1.67, 1.35, 1.66, 80]

			, [77.68, 109.13, -17.50,-1.67, 1.35, 1.66,50]/**/
			, [-30.440306021267492,125.36564291071822,-18.58769506,-1.5921799912480827,  -1.0399661678502943,  -1.5955909248070625,50]

		];
		var myPreviewManager = new PreviewManager(myMain.camera, mydata, myVideoManager);
		//myPreviewManager.createCameraButton('./img/1.png', './img/2.png');
		//结束自动漫游路径
		function f00() {
			requestAnimationFrame(f00);
			if(!myVideoManager.finish&&document.getElementById("cheat").style.visibility==='hidden'){
				myVideoManager.setPlay()
				myPreviewManager.myMoveManager.stopFlag = false;
			}
		}f00()

		//开始帧数统计
		var tag = document.createElement('h1');
		window.tag=tag;
		tag.style.cssText =
				'color:green;' +//文字颜色
				'font-size:' + 20 + 'px;' +//文字大小
				'font-weight:normal;' +
				'position:fixed;' +//到窗体的位置
				'left:' + 0 + 'px;' +//到部件左边距离
				'top:' + 0 + 'px;'; //到部件右边 距离
		document.body.appendChild(tag);
		var frameIndex = 0, frameIndexPre = 0;
		frameIndexUpdate();
		setInterval(computeFPS, 1000);
		function frameIndexUpdate() {
			frameIndex++;
			requestAnimationFrame(frameIndexUpdate);
		}
		function computeFPS() {
			tag.innerHTML =(frameIndex - frameIndexPre);
			//tag.innerHTML = "FPS:" + (frameIndex - frameIndexPre);
			frameIndexPre = frameIndex;
		}
		//完成帧数统计

		//开始添加时钟
		window.myClock=0;
		setInterval(function () {
			window.myClock++;
		},1)
		//完成添加时钟
	</script>
	</body>
</html>
